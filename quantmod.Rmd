---
Package: quantmod

author: Zhao Sibo,Deng YiQun,Long Xicheng
---

```{r ,include = FALSE}
library(rmarkdown)
library(zoo)
library(TTR)
library(xts)
library(quantmod)
```

# 一、ETL类函数

## （一）常用的数据类型

|数据类型|全称|意义|
|:-:|:-:|:-:|
|Op| Open price|开盘价|
|Hi |High price|最高价|
|Lo |Low price|最低价|
|Cl |Close price|收盘价|
|Vo |Volume|交易量|
|Ad |Adjusted price|调整价格|
|HLC| Hi,Lo,Cl|最高价、最低价和收盘价|
|OHLC| Op,Hi,Lo,Cl|开盘价、最高价、最低价和收盘价|

## （二）ETL类函数

|函数|作用|函数|作用|
|:-:|:-:|:-:|:-:|
|getSymbols()|从多种信息源里获得信息|getSymbols.csv()|从csv文件中读入数据|
|getDividends()|获取上市公司的股息数据|getSymbols.FRED()|从FRED中获取数据|
|getFinancials()|获取上市公司的财务报表|getSymbols.goole()|从google中获取数据|
|getFX()|获取汇率数据|getSymbols.MySQL|从MySQL中获取数据|
|getMetals()|获取重金属交易数据|getSymbols.oanda()|从oanda中获取数据|
|getSplits|获取上市公司的拆股数据|getSybols.rda()|从R的二进制文件获取数据|
|getOptionChain()|获取期权交易数据|getSymbols.SQLite()|从SQLite数据库中获取数据|
|getQuote()|获取即时的网络报价|getSymbols.yahoo()|从雅虎网中获取数据|

### 1.getSymbols函数

获取上市公司股票的日交易数据

```{r,message=FALSE}
   getSymbols("EDU",src = "yahoo",from="2013-8-20",to="2013-9-02")
   class(EDU)
   pander::pander(EDU,split.cells = 4)
```

**环境参数的介绍**
在全局环境下新建容器，容器是存放对象的。对象的名称是new.environment。通过ls()列出new.environment容器下AAPL变量值.
获取数据，并将获取后的记录放到AAPL中。AAPL通过env参数指定容器。通过get()获取new.environment容器下AAPL变量值。

```{r,message=FALSE}
  getSymbols("AAPL",env=new.environment,scr="yahoo",from="2013-10-01",to="2013-10-10")
  ls(envir=new.environment)
  pander::pander( new.environment[["AAPL"]],split.cells = 3)
```

**获取各种指数的日数据**，例如获取沪深300指数的日数据，它的代码为00300.ss，后面的字母表示该指数从属哪个交易所。

```{r, message=FALSE}
  getSymbols("000300.ss",env=new.environment,scr ="yahoo",from="2013-10-01",to="2013-10-10")
  ls(envir = new.environment)
  pander::pander(new.environment[["000300.ss"]],split.cells =3)
```

### 2.getFX() 函数
从oanda上获取汇率

```{r,message=FALSE}
  getFX("HKD/USD",from="2013-10-20",env=new.environment)
  pander::pander(new.environment[["HKD/USD"]],split.cells =3)
```

### 3.getFianacials()函数
从Google Finance上下载财务报表，其中包括IS/BS/CF,"Q"代表季度的数据
```{r,message=FALSE}
  getFinancials("AAPL")
  pander::pander(new.environment[[AAPL]],split.cells =3)
  viewFinancials(AAPL.f)
  viewFinancials(AAPL.f,c("CF","IS","BS"),"Q")
```

### 4.getDividends
```{r,message=FALSE}
getDividends("AAPL",env = new.environment,from =" 2012-01-01",to="2013-10-25",vrobose=TRUE)
pander::pander(new.environment[["AAPL"]])
```

# 二、分析类函数

**1.is 族函数**
**2.hash 族函数**
**3.列名函数**
**4.计算函数**


# 三、展现类函数






 
 

 

 

 
## （一）is 族函数
判断某数据是否是某类型的数据
 
    is.OHLC() --Open price,High price,Low price Close price 开盘价，最高价，最低价和收盘价
    is.OHLCV() --V 交易量
    is.BBO()
    is.TBBO()
    is.HLC()
 
## （二）hash 函数
检查数据里面是否包含某类型的数据

    has.OHLC()
    has.HLC()
    has.OHLCV()
    has.Op()
    has.Hi()
    has.Lo()
    has.Cl()
    has.Vo()
    has.Ad()
    has.Ask()
    has.Bid()
    has.Price()
    has.Qty()
    has.Trade()

 
 
 
has.Op(AAPL) #是否包含开盘价
has.OHLC(AAPL) #是否包含开盘价，最高价，最低价，收盘价

 
3.列名函数
提取某种类型
> Op(AAPL)
           
 
> Hi(AAPL)
           
 
> Lo(AAPL)

 
4.计算函数
 
Delt() 计算变化率
Lag() 求滞后K期
Next() 所有观测值的值前进k个单位
first() 求前K个元素
last() 求后K个元素
计算不同阶段的收益率
periodReturn()
dailyReturn()
weeklyReturn()
monthlyReturn()
quarterlyReturn()
annualReturn()
yearlyReturn()
allReturn()
 
Delt()函数
主要是用来计算一个序列的一个阶段到另一个阶段的变化率或者计算两个序列之间的变化率
 
 
--当天减去前一天的值，然后除以前一天的值
> Delt(Op(AAPL),type=("arithmetic"))
         
 
--(关盘价-开盘价)/开盘价
> Delt(Op(AAPL),Cl(AAPL))
          
 
 
--元素前进一天,485.63 本来是2013-10-02的数据
> Next(AAPL,1)
           
将数据转化为周数据或者月数据
 
周，将周初的开盘价作为开盘价，周内的最低价及最高价作为最高最低价
交易量则汇总周内的所有交易量
> to.weekly(AAPL)
          
月，则将月初的开盘价作为开盘价，月初的关盘价作为月末的关盘价，
月内的最高价和最低价作为最高低价，交易量则汇总
> to.monthly(AAPL)
          
 
--分别获取AAPL,MSFT,ORCL,GOOG的信息数据，并存入变量
getSymbols(c("AAPL","MSFT","ORCL","GOOG"),env=new.environment,scr="yahoo")
 
 
求出Apple公司在2013.1-2013.10的股票总成交量使用
1.getSymbols("AAPL",env=new.environment,scr="yahoo",from="2013-01-01",to="2013-10-31")
--将每个月的汇总数据放入变量AAPL中
2.a=to.monthly(get("AAPL",envir=new.environment))
--汇总1到10月的数据,汇总值为第五个Volume
3.sum(a[1:10,5])
 
 
 
找出这些股票暴涨暴跌的时间点（例如开盘价或收盘价比前一天涨跌幅度超过2%）
 
AAPL.Cl<-Delt(Cl(get("AAPL",envir=new.environment)),type=("arithmetic"))
AAPL.Cl[which(abs(AAPL.Cl)>0.02),]
plot(AAPL.Cl)

