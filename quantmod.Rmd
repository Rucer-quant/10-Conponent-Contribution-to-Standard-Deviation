---
Package: quantmod

author: Zhao Sibo,Deng YiQun,Long Xicheng
---

```{r ,include = FALSE}
library(rmarkdown)
library(zoo)
library(TTR)
library(xts)
library(quantmod)
```

# 一、ETL类函数

## （一）常用的数据类型


## （二）ETL类函数

|函数|作用|函数|作用|
|:-:|:-:|:-:|:-:|
|getSymbols()|从多种信息源里获得信息|getSymbols.csv()|从csv文件中读入数据|
|getDividends()|获取上市公司的股息数据|getSymbols.FRED()|从FRED中获取数据|
|getFinancials()|获取上市公司的财务报表|getSymbols.goole()|从google中获取数据|
|getFX()|获取汇率数据|getSymbols.MySQL|从MySQL中获取数据|
|getMetals()|获取重金属交易数据|getSymbols.oanda()|从oanda中获取数据|
|getSplits|获取上市公司的拆股数据|getSybols.rda()|从R的二进制文件获取数据|
|getOptionChain()|获取期权交易数据|getSymbols.SQLite()|从SQLite数据库中获取数据|
|getQuote()|获取即时的网络报价|getSymbols.yahoo()|从雅虎网中获取数据|

### 1.getSymbols函数

获取上市公司股票的日交易数据

```{r,message=FALSE}
   getSymbols("EDU",src = "yahoo",from="2013-8-20",to="2013-9-02")
   class(EDU)
   pander::pander(EDU,split.cells = 4)
```

**环境参数的介绍**
在全局环境下新建容器，容器是存放对象的。对象的名称是new.environment。通过ls()列出new.environment容器下AAPL变量值.
获取数据，并将获取后的记录放到AAPL中。AAPL通过env参数指定容器。通过get()获取new.environment容器下AAPL变量值。

```{r}
  new.environment=new.env()
  getSymbols("AAPL",env=new.environment,scr="yahoo",from="2013-10-01",to="2013-10-10")
  ls(envir=new.environment)
  pander::pander(head( new.environment[["AAPL"]]),split.cells = 3)
```

**获取各种指数的日数据**，例如获取沪深300指数的日数据，它的代码为00300.ss，后面的字母表示该指数从属哪个交易所。

```{r message=TRUE}
  getSymbols("000300.ss",env=new.environment,scr ="yahoo",from="2013-10-01",to="2013-12-10")
  ls(envir = new.environment)
  pander::pander(head(new.environment[["000300.SS"]]),split.cells =3)
```

<!-- ### 2.getFX() 函数 -->
<!-- 从oanda上获取汇率 -->

<!-- ```{r eval=FALSE, include=FALSE, r,message=FALSE} -->
<!--   getFX("HKD/USD",from="2019-06-20",env=new.environment) -->
<!--   pander::pander(new.environment[["HKD/USD"]],split.cells =3) -->
<!-- ``` -->

<!-- ### 3.getFianacials()函数 -->
<!-- 从Google Finance上下载财务报表，其中包括IS/BS/CF,"Q"代表季度的数据 -->
<!-- ```{r eval=FALSE, include=FALSE, r,message=FALSE} -->
<!--   getFinancials("AAPL") -->
<!--   pander::pander(new.environment[[AAPL]],split.cells =3) -->
<!--   viewFinancials(AAPL.f) -->
<!--   viewFinancials(AAPL.f,c("CF","IS","BS"),"Q") -->
<!-- ``` -->

### 4.getDividends
```{r,message=FALSE}
getDividends("AAPL",env = new.environment,from =" 2012-01-01",to="2013-10-25",vrobose=TRUE)
pander::pander(new.environment[["AAPL"]])
```

# 二、分析类函数

**1.is 族函数**
**2.hash 族函数**
**3.列名函数**
**4.计算函数**

 
## （一）列名函数
提取某种类型

|数据类型|全称|意义|
|:-:|:-:|:-:|
|Op| Open price|开盘价|
|Hi |High price|最高价|
|Lo |Low price|最低价|
|Cl |Close price|收盘价|
|Vo |Volume|交易量|
|Ad |Adjusted price|调整价格|
|HLC| Hi,Lo,Cl|最高价、最低价和收盘价|
|OHLC| Op,Hi,Lo,Cl|开盘价、最高价、最低价和收盘价|

```{r}
  getSymbols("AAPL",from="2013-09-01", to="2013-09-20")
  Op(AAPL)
  Hi(AAPL)
  Lo(AAPL)
```
 

## （二）is 族函数
判断某数据是否是某类型的数据
 
    is.OHLC() --Open price,High price,Low price Close price 开盘价，最高价，最低价和收盘价
    is.OHLCV() --V 交易量
    is.BBO()
    is.TBBO()
    is.HLC()
 
## （三）hash 函数
检查数据里面是否包含某类型的数据

    has.OHLC()
    has.HLC()
    has.OHLCV()
    has.Op()
    has.Hi()
    has.Lo()
    has.Cl()
    has.Vo()
    has.Ad()
    has.Ask()
    has.Bid()
    has.Price()
    has.Qty()
    has.Trade()

```{r,message=FALSE}
  #检查数据里面包含某种数据类型
  #是否包含开盘价
  has.Op(AAPL) 
  #是否包含开盘价，最高价，最低价，收盘价
  has.OHLC(AAPL)
  has.OHLC(AAPL,which=FALSE)

  has.OHLC(AAPL,which=TRUE)
```
 
 
## （四）计算函数

|函数|描述|
|:-:|:-:|
|Delt()|计算变化率|
|Lag()|求滞后K期|
|Next()|所有观测值的值前进k个单位|
|first()|求前K个元素|
|last()|求后K个元素|
|periodReturn()|计算不同阶段的收益率|
|dailyReturn()|计算日收益率|
|weeklyReturn()|计算周收益率|
|monthlyReturn()|计算月收益率|
|quarterlyReturn()|计算季度收益率|
|annualReturn()|计算年化收益率|
|yearlyReturn()|计算年收益率|
|allReturn()|各种收益率汇总|

**Delt()函数**
主要是用来计算一个序列的一个阶段到另一个阶段的变化率或者计算两个序列之间的变化率

```{r}
  #当天减去前一天的值，然后除以前一天的值,
  Delt(Op(AAPL),type=("arithmetic"))#算数
  Delt(Op(AAPL),type=("log"))#对数
  #(关盘价-开盘价)/开盘价
  Delt(Op(AAPL),Cl(AAPL))
            

```


**Next()函数**
```{r}
  head(AAPL)
  #所有观测值的值前进k个单位
  Next(AAPL,1)
```

**Return系列**
```{r}
  getSymbols("AAPL")
  periodReturn(AAPL,period = "daily",subset = "2013-10-01::2013-10-23",type = "arithmetic")
  head(dailyReturn(AAPL))
  first(allReturns(AAPL),5)
```


# 三、展现类函数

# 这里图完善一下图的名字

## （一）基础图形的作图——条形图，蜡烛图，线图

|作图函数|描述|
|:-:|:-:|
|chartTheme()|啥啥啥|
|chartSeries()|啥都是|
|reChart()|啥|
|barChart()|箱型图|
|candleChart()|蜡烛图|
|lineChart()|线图|

**chartserises()**
主绘图函数，可以画条形图，蜡烛图和线图

```{r}
chartSeries(AAPL,name = "AAPLCHART",subset = "2013-10-01::2013-10-23")

chartSeries(AAPL,name = "AAPLCHART",subset = "2013-10-01::2013-10-23",theme = "white")

#适合印刷
chartSeries(AAPL,name = "AAPLCHART",subset = "2013-10-01::2013-10-23",theme = "white.mono")

chart_Series(AAPL,type = "auto",subset = "2013-10-01::2013-10-23")
chart_Series(AAPL,type = "candlesticks",subset = "2013-10-01::2013-10-23")
chart_Series(AAPL,type = "bar",subset = "2013-10-01::2013-10-23")
chart_Series(AAPL,type = "line",subset = "2013-10-01::2013-10-23")
chart_Series(AAPL,type = "matchsticks",subset = "2013-10-01::2013-10-23")

```

**reChart()**
可以在不重新再画一张新的图的前提下修改已经画出来的图

```{r}
chartSeries(AAPL,name="AAPLBARCHART",subset="2013-10-01::2013-10-23",type="candlesticks")
reChart(type = "bars",subset ="2013-10-01::2013-10-23" ,show.grid = TRUE)
```

**barChart()**
barchar()特有的bartype
```{r}
getSymbols("AAPL",scr="yahoo")
barChart(AAPL,theme = "white")
barChart(AAPL,theme = "white",subset = "2012-12::2013")
barChart(AAPL,theme = "white",subset = "last 10 weeks")
barChart(AAPL,theme = "white",subset = "first 10 weeks")

#bartype
barChart(AAPL,theme = "white",subset = "first 10 weeks",bar.type = "ohlc")
barChart(AAPL,theme = "white",subset = "first 10 weeks",bar.type = "hlc")

```

**lineChart()**
```{r}
lineChart(AAPL,theme = "white",subset = "2013-10-01::2013-10-23",line.type = "l")
lineChart(AAPL,theme = "white",subset = "2013-10-01::2013-10-23",line.type = "p")
lineChart(AAPL,theme = "white",subset = "2013-10-01::2013-10-23",line.type = "b")
  
```

## （二）技术分析图

|技术分析图函数|描述|
  |:-:|:-:|
  |addADX()||
  |addATR()||
  |addBBands()||
  |addCCI()||
  |addCMF()||
  |addCMO()||
  |addEMA()||
  |addEnvelope()||
  |addMACD()||
  |addMomentum()||
  |addExpiry()||
  |addSAR()||
  |addSMA()||
  |addSMI()||
  |addDEMA()||
  |addDPO()||
  |addROC()||
  |addRSI()||
  |addVo()||
  |addWMA()||
  |addWPR()||
  |addZLEMA()||
  |addZigZag()||
  
例ADX
```{r}
chartSeries(AAPL,name="AAPLBARCHART",subset="2013-08-01::2013-10-23",type="candlesticks",theme = "white")
addADX()

chartSeries(AAPL,name="AAPLBARCHART",subset="2013-08-01::2013-10-23",type="candlesticks")
addBBands(n=14,sd=2,draw = "percent")

chartSeries(AAPL,name="AAPLBARCHART",subset="2013-08-01::2013-10-23",type="candlesticks")
addBBands(n=14,sd=2,draw = "width")

chartSeries(AAPL,name="AAPLBARCHART",subset="2013-08-01::2013-10-23",type="candlesticks")
addCCI()

chartSeries(AAPL,name="AAPLBARCHART",subset="2013-08-01::2013-10-23",type="candlesticks")
addRSI()

chartSeries(AAPL,name="AAPLBARCHART",subset="2013-08-01::2013-10-23",type="candlesticks")
addVo()

chartSeries(AAPL,name="AAPLBARCHART",subset="2013-08-01::2013-10-23",type="candlesticks")
addWPR()

chartSeries(AAPL,name="AAPLBARCHART",subset="2013-08-01::2013-10-23",type="candlesticks")
addSAR()

chartSeries(AAPL,name="AAPLBARCHART",subset="2013-08-01::2013-10-23",type="candlesticks")
addDPO()

```
  


